CREATE EXTERNAL TABLE dev_evolv_stg.`mobile_trx`(
`trigger_type` int,
`time` timestamp,
`trx_date` string,
`trx_hour` tinyint,
`subscriber_identifier` string,
`imsi` string,
`msisdn` string,
`subs_id` string,
`pre_post_flag` tinyint,
`price_plan_id` int,
`price_plan` string,
`cust_type_desc` string,
`cust_subtype_desc` string,
`imei` string,
`tac` string,
`paid_type` bigint,
`category` string,
`home_service_zone` string,
`visit_service_zone` string,
`cgi` string,
`sai` string,
`ecgi` string,
`rai` string,
`access_type` int,
`node_type` string,
`lac` string,
`ci` string,
`lacci_id` string,
`lacci_closing_flag` tinyint,
`area_sales` string,
`region_sales` string,
`branch` string,
`sub_branch` string,
`cluster` string,
`provinsi` string,
`kabupaten` string,
`kecamatan` string,
`kelurahan` string,
`sgsn_address` string,
`mccmnc` string,
`mcc` string,
`mnc` string,
`roaming_status` tinyint,
`roaming_region` string,
`ipcan_type` int,
`ueip` string,
`apn` string,
`download_bandwidth` bigint,
`upload_bandwidth` bigint,
`service_package_name` string,
`service_name` string,
`rule_name` string,
`quota_name` string,
`data_user_type` string,
`quota_status` smallint,
`quota_consumption` bigint,
`quota_balance` bigint,
`quota_recharge` bigint,
`quota_usage` bigint,
`quotanext_reset_time` timestamp,
`account_name` string,
`account_status` smallint,
`account_privilege` smallint,
`personal_value` decimal(19,4),
`account_balance` decimal(19,4),
`account_consumption` decimal(19,4),
`account_usage` decimal(19,4),
`pcr_fip_address` string,
`accountnext_reset_time` string,
`ueipv6` string,
`angw_address` string,
`access_node_status` smallint,
`tai` string,
`under_control` tinyint,
`old_quota_status` smallint,
`old_quota_consumption` bigint,
`old_quota_balance` bigint,
`quota_reset_time` timestamp,
`old_account_status` smallint,
`old_account_privilege` smallint,
`old_account_balance` decimal(19,4),
`old_account_consumption` decimal(19,4),
`account_reset_time` timestamp,
`quota_last_reset_time` timestamp,
`roaming_region_2` string,
`roaming_region_3` string,
`roaming_region_4` string,
`roaming_region_5` string,
`roaming_region_6` string,
`roaming_region_7` string,
`roaming_region_8` string,
`roaming_region_9` string,
`roaming_region_10` string,
`quota_value_or_status` tinyint,
`visit_service_zone_2` string,
`visit_service_zone_3` string,
`visit_service_zone_4` string,
`visit_service_zone_5` string,
`accumulation_value` bigint,
`accumulation_balance` bigint,
`accumulation_consumption` bigint,
`accumulation_starttime` timestamp,
`accumulation_endtime` timestamp,
`accumulation_expire_flag` smallint,
`old_accumulation_value` bigint,
`old_accumulation_balance` bigint,
`old_accumulation_consumption` bigint,
`old_accumulation_starttime` timestamp,
`old_accumulation_endtime` timestamp,
`activation_time_value` bigint,
`activation_start_time` timestamp,
`activation_end_time` timestamp,
`resttime_value` bigint,
`plmn_identify` string,
`time_zone` smallint,
`quota_value` bigint,
`service_start_datetime` timestamp,
`service_end_datetime` timestamp,
`service_description` string,
`service_customer_attribute` bigint,
`visit_service_zone_6` string,
`visit_service_zone_7` string,
`visit_service_zone_8` string,
`visit_service_zone_9` string,
`visit_service_zone_10` string,
`subscribed_date_time` timestamp,
`rarcause` smallint,
`trans_insubscriber_id` string,
`trans_inquota_name` string,
`transfer_quota_value` bigint,
`transfer_quota_starttime` timestamp,
`transfer_quota_endtime` timestamp,
`notification_indication` bigint,
`transfer_quota_balance` bigint,
`transfer_quota_consumption` bigint,
`transfer_timestamp` timestamp,
`oldactivation_starttime` timestamp,
`oldactivation_endtime` timestamp,
`oldrest_time_value` bigint,
`trans_inservice_name` string,
`cust` bigint,
`billingcycle_date` bigint,
`session_id` string,
`origin_host` string,
`originre_alm` string,
`destination_host` string,
`destination_realm` string,
`rxipv4` string,
`rxipv6` string,
`last_accumulate_value` bigint,
`current_cumulate_times` bigint,
`rxmedia_type` bigint,
`rx_specificaction` bigint,
`sy_policy_counter_identifier` string,
`sy_policy_counter_status` string,
`sy_pending_policy_counter_status1` string,
`sy_pndng_plcy_cntr_chng_time1` timestamp,
`sy_pending_policy_counter_status2` string,
`sy_pndng_plcy_cntr_chng_time2` timestamp,
`sy_pending_policy_counter_status3` string,
`sy_pndng_plcy_cntr_chng_time3` timestamp,
`sy_result_code` bigint,
`qci` bigint,
`client_less_optimization_rule` bigint,
`content_filtering_rule` bigint,
`fup` string,
`http_enrichment_rule` bigint,
`bmiimei` string,
`bmiimsi` string,
`operator_id` bigint,
`bmi_roaming_status` tinyint,
`service_extended_attribute_3` string,
`transfer` string,
`visit_service_zone_11` string,
`visit_service_zone_12` string,
`visit_service_zone_13` string,
`visit_service_zone_14` string,
`visit_service_zone_15` string,
`visit_service_zone_16` string,
`visit_service_zone_17` string,
`visit_service_zone_18` string,
`visit_service_zone_19` string,
`visit_service_zone_20` string,
`actual_quota_usage` bigint,
`rate_discount` bigint,
`actual_account_usage` bigint,
`usr_status` string,
`service_usage_state` string,
`reserved` string,
`reserved_1` string,
`reserved_2` string,
`service_extended_attribute1` string,
`service_extended_attribute2` string,
`net_loc_access_support` bigint,
`transaction_id` string,
`package_id` string,
`quota_sequence_id` bigint,
`old_quota_value` bigint,
`quota_expired_time` timestamp,
`old_quota_expired_time` timestamp,
`old_quota_sequence_id` string,
`quota_extended_attribute` string,
`channel_id` string,
`ts_ifrs` string,
`last_5_digit_msisdn` string,
`sigma_business_id` string,
`sigma_rules_id` string,
`brand_ifrs` string,
`l1` string,
`l2_l3` string,
`ifrs_param` string,
`ifrs15_ind_for_allowance_revenue` string,
`ifrs_allowance_type` string,
`proration_ind` string,
`allocated_tp` decimal(33,15),
`disc_allocated_tp` decimal(33,15),
`disc_validity` int,
`price_plan_product` string,
`historical_quota` int,
`ifrs_post_catalogue_ref_id` string,
`brand` string,
`l1_payu` string,
`l2_service_type` string,
`l3_allowance_type` string,
`l4_product_category` string,
`l5_product` string,
`commercial_name` string,
`channel` string,
`validity` string,
`unit_price` decimal(38,15),
`rev_per_usage` decimal(38,15),
`rev_seized` decimal(38,15),
`historical_unit_price` decimal(38,15),
`quota_to_rate` decimal(38,15),
`rev_per_usage_rollover` decimal(38,15),
`rev_seized_rollover` decimal(38,15),
`disc_unit_price` decimal(38,15),
`rev_per_usage_post` decimal(38,15),
`rev_seized_rollover_post` decimal(38,15),
`session_restore_type` smallint,
`group_sub_id` string,
`lacci_mostdom_parent` string,
`quota_flag` tinyint,
`file_id` string,
`load_ts` timestamp,
`load_user` string,
`ifrs_flag` string,
`lacci_id_ifrs` string,
`area_sales_ifrs` string,
`region_sales_ifrs` string,
`branch_ifrs` string,
`sub_branch_ifrs` string,
`cluster_ifrs` string,
`provinsi_ifrs` string,
`kabupaten_ifrs` string,
`kecamatan_ifrs` string,
`kelurahan_ifrs` string,
`lacci_closing_flag_ifrs` tinyint,
`lacci_mostdom_parent_ifrs` string,
`cust_id` int,
`site_name` string,
`region_hlr` string,
`city_hlr` string,
`customer_sub_segment` string,
`site_id` string,
`site_id_ifrs` string)
PARTITIONED BY (
`event_date` string)
ROW FORMAT SERDE
'org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe'
WITH SERDEPROPERTIES (
'field.delim'='??',
'serialization.format'='??')
STORED AS INPUTFORMAT
'org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat'
OUTPUTFORMAT
'org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat'